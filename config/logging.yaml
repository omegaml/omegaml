# a standard logging configuration for commercial environments
# -- logs as json
# -- always includes hostname
# -- always includes task filter
logging:
  version: 1
  disable_existing_loggers: true
  formatters:
     json:
       class: pythonjsonlogger.jsonlogger.JsonFormatter
       # https://docs.python.org/3/library/logging.html#logrecord-attributes
       format: "{asctime} {levelname} {hostname} {message} {requestId} {task_name} {module} {funcName} {name}"
       style: "{"
  filters:
     hostname:
       (): config.logutil.hostnameFilter
     task:
       (): config.logutil.taskFilter
     request:
       (): config.logutil.requestContextFilter
       drop:
        - data
        - result
        - request
  handlers:
     console:
       class: logging.StreamHandler
       stream: ext://sys.stdout
       formatter: json
       filters:
          - hostname
          - task
          - request
  loggers:
     root:
        handlers:
          - console
        level: DEBUG
     celery.task:
        handlers:
          - console
     django:
       handlers:
         - console



